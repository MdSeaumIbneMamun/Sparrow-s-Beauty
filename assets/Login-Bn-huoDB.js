import{n as e}from"./rolldown-runtime-y2wrX6ue.js";import{C as t,E as n,f as r,h as i,p as a,u as o,v as s,x as c,y as l}from"./bootstrap-vendor-LDj2otZe.js";import{A as u,T as d}from"./vendor-6AfST0Cy.js";import{A as f,k as p,lt as m}from"./fontawesome-vendor-CDyZyS_m.js";import{r as h}from"./index-Bm7Tf09k.js";/* empty css               */var g=e(n(),1),_=t();function v(){let[e,t]=(0,g.useState)(1),[n,v]=(0,g.useState)(``),[y,b]=(0,g.useState)(``),[x,S]=(0,g.useState)(``),[C,w]=(0,g.useState)(``),[T,E]=(0,g.useState)(!1),[D,O]=(0,g.useState)(null),[k,A]=(0,g.useState)(!1),[j,M]=(0,g.useState)(!1),[N,P]=(0,g.useState)(1),[F,I]=(0,g.useState)(``),[L,R]=(0,g.useState)(``),[z,B]=(0,g.useState)(``),[V,H]=(0,g.useState)(``),[U,W]=(0,g.useState)(!1),[G,K]=(0,g.useState)(null),[q,J]=(0,g.useState)(!1),{verifyPasswordAndSendOtp:Y,setUpRecaptcha:X,updateUserPassword:Z,migrateAccount:Q}=h(),$=u();return(0,_.jsxs)(i,{className:`d-flex align-items-center justify-content-center min-vh-100 signup-container`,children:[(0,_.jsx)(s,{className:`chic-auth-card`,children:(0,_.jsxs)(s.Body,{className:`p-4`,children:[(0,_.jsx)(`h2`,{className:`text-center mb-4 chic-title`,children:e===1?`Welcome Back`:`Security Check`}),C&&(0,_.jsx)(c,{variant:`danger`,className:`small`,children:C}),e===1&&(0,_.jsxs)(a,{onSubmit:async e=>{if(e.preventDefault(),w(``),E(!0),!n||n.length<10){w(`Enter valid phone.`),E(!1);return}if(!y){w(`Enter password.`),E(!1);return}let r=`+88`+n;try{let e=await Y(r,y);if(e&&e.isMaster){$(`/admin-master`);return}O(e),t(2)}catch(e){e.message===`ACCOUNT_NOT_FOUND`?w(`No account found with this number.`):e.message===`WRONG_PASSWORD`?w(`Incorrect password.`):w(e.message)}E(!1)},children:[(0,_.jsxs)(a.Group,{className:`mb-3`,children:[(0,_.jsx)(a.Label,{className:`chic-label`,children:`Phone Number`}),(0,_.jsxs)(r,{children:[(0,_.jsx)(r.Text,{className:`chic-prefix`,children:`+88`}),(0,_.jsx)(a.Control,{type:`tel`,className:`chic-input`,required:!0,value:n,onChange:e=>v(e.target.value.replace(/\D/g,``))})]})]}),(0,_.jsxs)(a.Group,{className:`mb-2`,children:[(0,_.jsx)(a.Label,{className:`chic-label`,children:`Password`}),(0,_.jsxs)(r,{children:[(0,_.jsx)(a.Control,{type:k?`text`:`password`,className:`chic-input`,required:!0,value:y,onChange:e=>b(e.target.value)}),(0,_.jsx)(l,{variant:`outline-secondary`,className:`chic-password-btn`,onClick:()=>A(!k),children:(0,_.jsx)(m,{icon:k?f:p})})]})]}),(0,_.jsx)(`div`,{className:`text-end mb-4`,children:(0,_.jsx)(`span`,{className:`chic-link small`,style:{cursor:`pointer`},onClick:()=>M(!0),children:`Forgot Password?`})}),(0,_.jsx)(`div`,{id:`recaptcha-container`}),(0,_.jsx)(l,{disabled:T,className:`w-100 chic-btn`,type:`submit`,children:T?`Verifying...`:`Login`})]}),e===2&&(0,_.jsxs)(a,{onSubmit:async e=>{if(e.preventDefault(),w(``),x.length!==6)return w(`Enter 6-digit code.`);try{E(!0);let e=await D.confirm(x);if(e._tokenResponse?.isNewUser){let t=`+88`+n;await Q(e.user.uid,t)}$(`/`)}catch(e){console.error(e),w(`Invalid OTP or System Error.`)}E(!1)},children:[(0,_.jsx)(`div`,{className:`text-center mb-3`,children:(0,_.jsxs)(`span`,{className:`text-muted small`,children:[`Code sent to +88`,n]})}),(0,_.jsx)(a.Group,{className:`mb-4`,children:(0,_.jsx)(a.Control,{type:`text`,placeholder:`------`,className:`chic-input text-center otp-input`,maxLength:`6`,required:!0,value:x,onChange:e=>S(e.target.value.replace(/\D/g,``))})}),(0,_.jsx)(l,{disabled:T,className:`w-100 chic-btn`,type:`submit`,children:T?`Verifying...`:`Confirm & Login`}),(0,_.jsx)(`div`,{className:`text-center mt-3`,children:(0,_.jsx)(`span`,{className:`back-link`,onClick:()=>t(1),children:`Back to Login`})})]}),(0,_.jsxs)(`div`,{className:`text-center mt-4 pt-3 border-top`,children:[(0,_.jsx)(`span`,{className:`text-muted small`,children:`New here? `}),(0,_.jsx)(d,{to:`/signup`,className:`chic-link`,children:`Create Account`})]})]})}),(0,_.jsxs)(o,{show:j,onHide:()=>{M(!1),P(1),I(``),R(``),B(``),H(``)},centered:!0,contentClassName:`chic-modal`,children:[(0,_.jsx)(o.Header,{closeButton:!0,className:`border-0`,children:(0,_.jsx)(o.Title,{className:`chic-title h5`,children:`Reset Password`})}),(0,_.jsxs)(o.Body,{children:[V&&(0,_.jsx)(c,{variant:`danger`,className:`small`,children:V}),N===1&&(0,_.jsxs)(a,{onSubmit:async e=>{e.preventDefault(),H(``),W(!0);try{K(await X(`+88`+F)),P(2)}catch(e){H(`Failed to send OTP. `+e.message)}W(!1)},children:[(0,_.jsx)(`p`,{className:`text-muted small mb-4`,children:`Enter phone to receive OTP.`}),(0,_.jsxs)(r,{className:`mb-3`,children:[(0,_.jsx)(r.Text,{className:`chic-prefix`,children:`+88`}),(0,_.jsx)(a.Control,{type:`tel`,className:`chic-input`,required:!0,value:F,onChange:e=>I(e.target.value.replace(/\D/g,``))})]}),(0,_.jsx)(l,{disabled:U,className:`w-100 chic-btn`,type:`submit`,children:`Send OTP`})]}),N===2&&(0,_.jsxs)(a,{onSubmit:async e=>{e.preventDefault(),H(``),W(!0);try{await G.confirm(L),P(3)}catch{H(`Invalid Code.`)}W(!1)},children:[(0,_.jsxs)(`p`,{className:`text-muted small mb-4`,children:[`Enter code sent to +88`,F]}),(0,_.jsx)(a.Control,{type:`text`,className:`chic-input text-center otp-input mb-3`,maxLength:`6`,required:!0,value:L,onChange:e=>R(e.target.value.replace(/\D/g,``))}),(0,_.jsx)(l,{disabled:U,className:`w-100 chic-btn`,type:`submit`,children:`Verify`})]}),N===3&&(0,_.jsxs)(a,{onSubmit:async e=>{e.preventDefault(),H(``),W(!0);try{await Z(`+88`+F,z),M(!1),$(`/`)}catch(e){H(`Failed: `+e.message)}W(!1)},children:[(0,_.jsx)(`p`,{className:`text-muted small mb-4`,children:`Set new password.`}),(0,_.jsxs)(r,{className:`mb-3`,children:[(0,_.jsx)(a.Control,{type:q?`text`:`password`,className:`chic-input`,placeholder:`New Password`,required:!0,minLength:`6`,value:z,onChange:e=>B(e.target.value)}),(0,_.jsx)(l,{variant:`outline-secondary`,className:`chic-password-btn`,onClick:()=>J(!q),children:(0,_.jsx)(m,{icon:q?f:p})})]}),(0,_.jsx)(l,{disabled:U,className:`w-100 chic-btn`,type:`submit`,children:`Update Password`})]})]})]})]})}export{v as default};